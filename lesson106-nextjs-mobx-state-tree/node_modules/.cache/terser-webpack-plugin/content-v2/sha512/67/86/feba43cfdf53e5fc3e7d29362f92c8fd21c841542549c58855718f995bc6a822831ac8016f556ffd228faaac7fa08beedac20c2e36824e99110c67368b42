{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{211:function(t,e,n){__NEXT_REGISTER_PAGE(\"/_app\",function(){return t.exports=n(245),{page:t.exports.default}})},212:function(t,e,n){(function(t){var r=void 0!==t&&t||\"undefined\"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(213),e.setImmediate=\"undefined\"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate=\"undefined\"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(40))},213:function(t,e,n){(function(t,e){!function(t,n){\"use strict\";if(!t.setImmediate){var r,i,o,a,s,u=1,p={},c=!1,l=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,\"[object process]\"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){d(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage(\"\",\"*\"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},r=function(t){o.port2.postMessage(t)}):l&&\"onreadystatechange\"in l.createElement(\"script\")?(i=l.documentElement,r=function(t){var e=l.createElement(\"script\");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(d,0,t)}:(a=\"setImmediate$\"+Math.random()+\"$\",s=function(e){e.source===t&&\"string\"==typeof e.data&&0===e.data.indexOf(a)&&d(+e.data.slice(a.length))},t.addEventListener?t.addEventListener(\"message\",s,!1):t.attachEvent(\"onmessage\",s),r=function(e){t.postMessage(a+e,\"*\")}),f.setImmediate=function(t){\"function\"!=typeof t&&(t=new Function(\"\"+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return p[u]=i,r(u),u++},f.clearImmediate=h}function h(t){delete p[t]}function d(t){if(c)setTimeout(d,0,t);else{var e=p[t];if(e){c=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{h(t),c=!1}}}}}(\"undefined\"==typeof self?void 0===t?this:t:self)}).call(this,n(40),n(114))},214:function(t,e,n){\"use strict\";var r=n(20),i=n(5);Object.defineProperty(e,\"__esModule\",{value:!0}),e.createUrl=V,e.Container=e.default=void 0;var o=i(n(47)),a=i(n(48)),s=i(n(215)),u=i(n(8)),p=i(n(9)),c=i(n(17)),l=i(n(18)),f=i(n(19)),h=i(n(14)),d=r(n(1)),y=i(n(30)),v=n(25),b=n(51),m=function(t){function e(){return(0,u.default)(this,e),(0,c.default)(this,(0,l.default)(e).apply(this,arguments))}var n;return(0,f.default)(e,t),(0,p.default)(e,[{key:\"getChildContext\",value:function(){return{headManager:this.props.headManager,router:(0,b.makePublicRouterInstance)(this.props.router)}}},{key:\"componentDidCatch\",value:function(t){throw t}},{key:\"render\",value:function(){var t=this.props,e=t.router,n=t.Component,r=t.pageProps,i=V(e);return d.default.createElement(g,null,d.default.createElement(n,(0,s.default)({},r,{url:i})))}}],[{key:\"getInitialProps\",value:(n=(0,a.default)(o.default.mark(function t(e){var n,r,i;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Component,e.router,r=e.ctx,t.next=3,(0,v.loadGetInitialProps)(n,r);case 3:return i=t.sent,t.abrupt(\"return\",{pageProps:i});case 5:case\"end\":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})}]),e}(d.Component);e.default=m,(0,h.default)(m,\"childContextTypes\",{headManager:y.default.object,router:y.default.object});var g=function(t){function e(){return(0,u.default)(this,e),(0,c.default)(this,(0,l.default)(e).apply(this,arguments))}return(0,f.default)(e,t),(0,p.default)(e,[{key:\"componentDidMount\",value:function(){this.scrollToHash()}},{key:\"componentDidUpdate\",value:function(){this.scrollToHash()}},{key:\"scrollToHash\",value:function(){var t=window.location.hash;if(t=!!t&&t.substring(1)){var e=document.getElementById(t);e&&setTimeout(function(){return e.scrollIntoView()},0)}}},{key:\"render\",value:function(){return this.props.children}}]),e}(d.Component);e.Container=g;var w=(0,v.execOnce)(function(){0});function V(t){var e=t.pathname,n=t.asPath,r=t.query;return{get query(){return w(),r},get pathname(){return w(),e},get asPath(){return w(),n},back:function(){w(),t.back()},push:function(e,n){return w(),t.push(e,n)},pushTo:function(e,n){w();var r=n?e:null,i=n||e;return t.push(r,i)},replace:function(e,n){return w(),t.replace(e,n)},replaceTo:function(e,n){w();var r=n?e:null,i=n||e;return t.replace(r,i)}}}},215:function(t,e,n){var r=n(80);function i(){return t.exports=i=r||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i.apply(this,arguments)}t.exports=i},245:function(t,e,n){\"use strict\";n.r(e);var r=n(81),i=n.n(r),o=n(1),a=n.n(o),s=n(41),u=n(32),p=n(82),c=n.n(p),l=null,f=u.c.model({lastUpdate:u.c.Date,light:!1}).actions(function(t){var e;return{start:function(){e=setInterval(function(){t.update()},1e3)},stop:function(){clearInterval(e)},update:function(){t.lastUpdate=Date.now(),t.light=!0}}});function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t&&(l=f.create({lastUpdate:Date.now()})),null===l&&(l=f.create({lastUpdate:Date.now()})),e&&Object(u.a)(l,e),l}function d(t){return(d=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function y(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function v(t,e){return!e||\"object\"!==d(e)&&\"function\"!=typeof e?function(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,\"default\",function(){return V});var V=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),(n=v(this,b(e).call(this,t))).store=h(t.isServer,t.initialState),n}return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(e,c.a),g(e,null,[{key:\"getInitialProps\",value:function(){var t,e=(t=i.a.mark(function t(e){var n,r,o,a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.Component,r=e.ctx,o=\"undefined\"==typeof window,a=h(o),s={},!n.getInitialProps){t.next=8;break}return t.next=7,n.getInitialProps(r);case 7:s=t.sent;case 8:return t.abrupt(\"return\",{initialState:Object(u.b)(a),isServer:o,pageProps:s});case 9:case\"end\":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,i){var o=t.apply(e,n);function a(t){y(o,r,i,a,s,\"next\",t)}function s(t){y(o,r,i,a,s,\"throw\",t)}a(void 0)})});return function(t){return e.apply(this,arguments)}}()}]),g(e,[{key:\"render\",value:function(){var t=this.props,e=t.Component,n=t.pageProps;return a.a.createElement(p.Container,null,a.a.createElement(s.a,{store:this.store},a.a.createElement(e,n)))}}]),e}()},32:function(t,e,n){\"use strict\";(function(t){n.d(e,\"c\",function(){return xt}),n.d(e,\"a\",function(){return A}),n.d(e,\"b\",function(){return x});var r=n(0),i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function a(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}var s,u=Object.freeze([]),p=Object.freeze({});function c(t){throw void 0===t&&(t=\"Illegal state\"),new Error(\"[mobx-state-tree] \"+t)}function l(t){return t}function f(){}function h(t){return!(!Array.isArray(t)&&!Object(r.i)(t))}function d(t){if(null===t||\"object\"!=typeof t)return!1;var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}function y(t){return!(null===t||\"object\"!=typeof t||t instanceof Date||t instanceof RegExp)}function v(t){return null==t||(\"string\"==typeof t||\"number\"==typeof t||\"boolean\"==typeof t||t instanceof Date)}function b(t){return v(t)?t:Object.freeze(t)}function m(t,e,n){Object.defineProperty(t,e,{enumerable:!1,writable:!1,configurable:!0,value:n})}function g(t,e){return t.push(e),function(){var n,r,i;r=e,-1!==(i=(n=t).indexOf(r))&&n.splice(i,1)}}function w(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n];return e}function V(t){switch(t.op){case\"add\":return{op:\"add\",path:t.path,value:t.value};case\"remove\":return{op:\"remove\",path:t.path};case\"replace\":return{op:\"replace\",path:t.path,value:t.value}}}function j(t){switch(t.op){case\"add\":return{op:\"remove\",path:t.path};case\"remove\":return{op:\"add\",path:t.path,value:t.oldValue};case\"replace\":return{op:\"replace\",path:t.path,value:t.oldValue}}}function P(t){return t.replace(/~/g,\"~1\").replace(/\\//g,\"~0\")}function T(t){return t.replace(/~0/g,\"/\").replace(/~1/g,\"~\")}function C(t){return 0===t.length?\"\":\"/\"+t.map(P).join(\"/\")}function O(t){var e=t.split(\"/\").map(T);return\"\"===e[0]?e.slice(1):e}function S(t){return\"object\"==typeof t&&t&&!0===t.isType}function _(t){return H(t).type}function A(t,e){return H(t).applySnapshot(e)}function x(t){return H(t).snapshot}function I(t){return H(t).root.storedValue}function N(t,e){var n=H(t);n.getChildren().forEach(function(t){L(t.storedValue)&&N(t.storedValue,e)}),e(n.storedValue)}!function(t){t[t.String=1]=\"String\",t[t.Number=2]=\"Number\",t[t.Boolean=4]=\"Boolean\",t[t.Date=8]=\"Date\",t[t.Literal=16]=\"Literal\",t[t.Array=32]=\"Array\",t[t.Map=64]=\"Map\",t[t.Object=128]=\"Object\",t[t.Frozen=256]=\"Frozen\",t[t.Optional=512]=\"Optional\",t[t.Reference=1024]=\"Reference\",t[t.Identifier=2048]=\"Identifier\",t[t.Late=4096]=\"Late\",t[t.Refinement=8192]=\"Refinement\",t[t.Union=16384]=\"Union\",t[t.Null=32768]=\"Null\",t[t.Undefined=65536]=\"Undefined\"}(s||(s={}));var k=1,D=null;function E(){return k++}function z(t,e){var n=H(t.context),r=n._isRunningAction,i=D;n.assertAlive(),n._isRunningAction=!0,D=t;try{return function(t,e,n){var r=function(t,e,n){var r=n.$mst_middleware||[],i=t;for(;i;)r=r.concat(i.middlewares),i=i.parent;return r}(t,0,n);if(!r.length)return n.apply(null,e.args);return function t(i){var o=r.shift();return o?o(i,t):n.apply(null,e.args)}(e)}(n,t,e)}finally{D=i,n._isRunningAction=r}}function R(t,e,n){var i=Object(r.c)(e,n);return i.$mst_middleware=n.$mst_middleware,function(){var n=E();return z({type:\"action\",name:e,id:n,args:w(arguments),context:t,tree:I(t),rootId:D?D.rootId:n,parentId:D?D.id:0},i)}}var F=function(){function t(){this.cache=r.l.map()}return t.prototype.addNodeToCache=function(t){if(t.identifierAttribute){var e=t.identifier;this.cache.has(e)||this.cache.set(e,r.l.shallowArray());var n=this.cache.get(e);-1!==n.indexOf(t)&&c(\"Already registered\"),n.push(t)}return this},t.prototype.mergeCache=function(t){var e=this;t.identifierCache.cache.values().forEach(function(t){return t.forEach(function(t){e.addNodeToCache(t)})})},t.prototype.notifyDied=function(t){if(t.identifierAttribute){var e=this.cache.get(t.identifier);e&&e.remove(t)}},t.prototype.splitCache=function(e){var n=new t,r=e.path;return this.cache.values().forEach(function(t){for(var e=t.length-1;e>=0;e--)0===t[e].path.indexOf(r)&&(n.addNodeToCache(t[e]),t.splice(e,1))}),n},t.prototype.resolve=function(t,e){var n=this.cache.get(e);if(!n)return null;var r=n.filter(function(e){return t.isAssignableFrom(e.type)});switch(r.length){case 0:return null;case 1:return r[0];default:return c(\"Cannot resolve a reference to type '\"+t.name+\"' with id: '\"+e+\"' unambigously, there are multiple candidates: \"+r.map(function(t){return t.path}).join(\", \"))}},t}(),M=1,U=function(){function t(t,e,n,i,o,a,s){void 0===a&&(a=l),void 0===s&&(s=f);var u=this;this.nodeId=++M,this._parent=null,this.subpath=\"\",this.isProtectionEnabled=!0,this.identifierAttribute=void 0,this._environment=void 0,this._isRunningAction=!1,this._autoUnbox=!0,this._isAlive=!0,this._isDetaching=!1,this.middlewares=[],this.snapshotSubscribers=[],this.patchSubscribers=[],this.disposers=[],this.type=t,this._parent=e,this.subpath=n,this._environment=i,this.unbox=this.unbox.bind(this),this.storedValue=a(o);var p,c=(p=this.storedValue)&&\"object\"==typeof p&&!(p instanceof Date)&&!L(p)&&!Object.isFrozen(p);this.applyPatches=R(this.storedValue,\"@APPLY_PATCHES\",function(t){t.forEach(function(t){var e=O(t.path);u.resolvePath(e.slice(0,-1)).applyPatchLocally(e[e.length-1],t)})}).bind(this.storedValue),this.applySnapshot=R(this.storedValue,\"@APPLY_SNAPSHOT\",function(t){if(t!==u.snapshot)return u.type.applySnapshot(u,t)}).bind(this.storedValue),e||(this.identifierCache=new F),c&&m(this.storedValue,\"$treenode\",this);var h=!0;try{c&&m(this.storedValue,\"toJSON\",$),this._isRunningAction=!0,s(this,o),this._isRunningAction=!1,e?e.root.identifierCache.addNodeToCache(this):this.identifierCache.addNodeToCache(this),this.fireHook(\"afterCreate\"),e&&this.fireHook(\"afterAttach\"),h=!1}finally{h&&(this._isAlive=!1)}var d=Object(r.n)(function(){return u.snapshot},function(t){u.emitSnapshot(t)});d.onError(function(t){throw t}),this.addDisposer(d)}return Object.defineProperty(t.prototype,\"identifier\",{get:function(){return this.identifierAttribute?this.storedValue[this.identifierAttribute]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){return this.parent?this.parent.path+\"/\"+P(this.subpath):\"\"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"isRoot\",{get:function(){return null===this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"root\",{get:function(){for(var t,e=this;t=e.parent;)e=t;return e},enumerable:!0,configurable:!0}),t.prototype.getRelativePathTo=function(t){this.root!==t.root&&c(\"Cannot calculate relative path: objects '\"+this+\"' and '\"+t+\"' are not part of the same object tree\");for(var e=O(this.path),n=O(t.path),r=0;r<e.length&&e[r]===n[r];r++);return e.slice(r).map(function(t){return\"..\"}).join(\"/\")+C(n.slice(r))},t.prototype.resolve=function(t,e){return void 0===e&&(e=!0),this.resolvePath(O(t),e)},t.prototype.resolvePath=function(t,e){void 0===e&&(e=!0);for(var n=this,r=0;r<t.length;r++){if(\"\"===t[r])n=n.root;else if(\"..\"===t[r])n=n.parent;else{if(\".\"===t[r]||\"\"===t[r])continue;if(n){n=n.getChildNode(t[r]);continue}}if(!n)return e?c(\"Could not resolve '\"+t[r]+\"' in '\"+C(t.slice(0,r-1))+\"', path of the patch does not resolve\"):void 0}return n},Object.defineProperty(t.prototype,\"value\",{get:function(){if(this._isAlive)return this.type.getValue(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"isAlive\",{get:function(){return this._isAlive},enumerable:!0,configurable:!0}),t.prototype.die=function(){this._isDetaching||L(this.storedValue)&&(N(this.storedValue,function(t){return H(t).aboutToDie()}),N(this.storedValue,function(t){return H(t).finalizeDeath()}))},t.prototype.aboutToDie=function(){this.disposers.splice(0).forEach(function(t){return t()}),this.fireHook(\"beforeDestroy\")},t.prototype.finalizeDeath=function(){this.root.identifierCache.notifyDied(this);var t,e,n,r=this,i=this.path;t=this,e=\"snapshot\",n=this.snapshot,Object.defineProperty(t,e,{enumerable:!0,writable:!1,configurable:!0,value:n}),this.patchSubscribers.splice(0),this.snapshotSubscribers.splice(0),this.patchSubscribers.splice(0),this._isAlive=!1,this._parent=null,this.subpath=\"\",Object.defineProperty(this.storedValue,\"$mobx\",{get:function(){c(\"This object has died and is no longer part of a state tree. It cannot be used anymore. The object (of type '\"+r.type.name+\"') used to live at '\"+i+\"'. It is possible to access the last snapshot of this object using 'getSnapshot', or to create a fresh copy using 'clone'. If you want to remove an object from the tree without killing it, use 'detach' instead.\")}})},t.prototype.assertAlive=function(){this._isAlive||c(this+\" cannot be used anymore as it has died; it has been removed from a state tree. If you want to remove an element from a tree and let it live on, use 'detach' or 'clone' the value\")},Object.defineProperty(t.prototype,\"snapshot\",{get:function(){if(this._isAlive)return b(this.type.getSnapshot(this))},enumerable:!0,configurable:!0}),t.prototype.onSnapshot=function(t){return g(this.snapshotSubscribers,t)},t.prototype.emitSnapshot=function(t){this.snapshotSubscribers.forEach(function(e){return e(t)})},t.prototype.applyPatchLocally=function(t,e){this.assertWritable(),this.type.applyPatchLocally(this,t,e)},t.prototype.onPatch=function(t){return g(this.patchSubscribers,t)},t.prototype.emitPatch=function(t,e){if(this.patchSubscribers.length){var n=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r];for(var o in i)t[o]=i[o]}return t}({},t,{path:e.path.substr(this.path.length)+\"/\"+t.path}),r=(\"oldValue\"in(a=n)||c(\"Patches without `oldValue` field cannot be inversed\"),[V(a),j(a)]),i=r[0],o=r[1];this.patchSubscribers.forEach(function(t){return t(i,o)})}var a;this.parent&&this.parent.emitPatch(t,e)},t.prototype.setParent=function(t,e){void 0===e&&(e=null),this.parent===t&&this.subpath===e||(t&&(this._parent&&t!==this._parent&&c(\"A node cannot exists twice in the state tree. Failed to add \"+this+\" to path '\"+t.path+\"/\"+e+\"'.\"),this._parent||t.root!==this||c(\"A state tree is not allowed to contain itself. Cannot assign \"+this+\" to path '\"+t.path+\"/\"+e+\"'\"),!this._parent&&this._environment&&this._environment!==t._environment&&c(\"A state tree cannot be made part of another state tree as long as their environments are different.\")),this.parent&&!t?this.die():(this.subpath=e||\"\",t&&t!==this._parent&&(t.root.identifierCache.mergeCache(this),this._parent=t,this.fireHook(\"afterAttach\"))))},t.prototype.addDisposer=function(t){this.disposers.unshift(t)},t.prototype.isRunningAction=function(){return!!this._isRunningAction||!this.isRoot&&this.parent.isRunningAction()},t.prototype.addMiddleWare=function(t){return g(this.middlewares,t)},t.prototype.getChildNode=function(t){this.assertAlive(),this._autoUnbox=!1;var e=this.type.getChildNode(this,t);return this._autoUnbox=!0,e},t.prototype.getChildren=function(){this.assertAlive(),this._autoUnbox=!1;var t=this.type.getChildren(this);return this._autoUnbox=!0,t},t.prototype.getChildType=function(t){return this.type.getChildType(t)},Object.defineProperty(t.prototype,\"isProtected\",{get:function(){return this.root.isProtectionEnabled},enumerable:!0,configurable:!0}),t.prototype.assertWritable=function(){this.assertAlive(),!this.isRunningAction()&&this.isProtected&&c(\"Cannot modify '\"+this+\"', the object is protected and can only be modified by using an action.\")},t.prototype.removeChild=function(t){this.type.removeChild(this,t)},t.prototype.detach=function(){this._isAlive||c(\"Error while detaching, node is not alive.\"),this.isRoot||(this.fireHook(\"beforeDetach\"),this._environment=this.root._environment,this._isDetaching=!0,this.identifierCache=this.root.identifierCache.splitCache(this),this.parent.removeChild(this.subpath),this._parent=null,this.subpath=\"\",this._isDetaching=!1)},t.prototype.unbox=function(t){return t&&!0===this._autoUnbox?t.value:t},t.prototype.fireHook=function(t){var e=this.storedValue&&\"object\"==typeof this.storedValue&&this.storedValue[t];\"function\"==typeof e&&e.apply(this.storedValue)},t.prototype.toString=function(){var t=this.identifier?\"(id: \"+this.identifier+\")\":\"\";return this.type.name+\"@\"+(this.path||\"<root>\")+t+(this.isAlive?\"\":\"[dead]\")},a([r.l],t.prototype,\"_parent\",void 0),a([r.l],t.prototype,\"subpath\",void 0),a([r.d],t.prototype,\"path\",null),a([r.d],t.prototype,\"value\",null),a([r.d],t.prototype,\"snapshot\",null),t}();function L(t){return!(!t||!t.$treenode)}function H(t){return L(t)?t.$treenode:c(\"Value \"+t+\" is no MST Node\")}function $(){return H(this).snapshot}function J(t,e,n,r,i,o,a){if(void 0===o&&(o=l),void 0===a&&(a=f),L(i)){var s=H(i);return s.isRoot||c(\"Cannot add an object to a state tree if it is already part of the same or another state tree. Tried to assign an object to '\"+(e?e.path:\"\")+\"/\"+n+\"', but it lives already at '\"+s.path+\"'\"),s.setParent(e,n),s}return new U(t,e,n,r,i,o,a)}function W(t,e,n){return t.concat([{path:e,type:n}])}function B(){return u}function G(t,e,n){return[{context:t,value:e,message:n}]}function q(t){return t.reduce(function(t,e){return t.concat(e)},[])}var Y=function(){function t(t){this.isType=!0,this.name=t}return t.prototype.create=function(t,e){return void 0===t&&(t=this.getDefaultSnapshot()),this.instantiate(null,\"\",e,t).value},t.prototype.isAssignableFrom=function(t){return t===this},t.prototype.validate=function(t,e){return L(t)?_(t)===this||this.isAssignableFrom(_(t))?B():G(e,t):this.isValidSnapshot(t,e)},t.prototype.is=function(t){return 0===this.validate(t,[{path:\"\",type:this}]).length},t.prototype.reconcile=function(t,e){if(t.snapshot===e)return t;if(L(e)&&H(e)===t)return t;if(t.type===this&&y(e)&&!L(e)&&(!t.identifierAttribute||t.identifier===e[t.identifierAttribute]))return t.applySnapshot(e),t;var n=t.parent,r=t.subpath;if(t.die(),L(e)&&this.isAssignableFrom(_(e))){var i=H(e);return i.setParent(n,r),i}return this.instantiate(n,r,t._environment,e)},Object.defineProperty(t.prototype,\"Type\",{get:function(){return c(\"Factory.Type should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.Type`\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"SnapshotType\",{get:function(){return c(\"Factory.SnapshotType should not be actually called. It is just a Type signature that can be used at compile time with Typescript, by using `typeof type.SnapshotType`\")},enumerable:!0,configurable:!0}),a([r.c],t.prototype,\"create\",null),t}(),X=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t){return t.storedValue},e.prototype.getDefaultSnapshot=function(){},e.prototype.applySnapshot=function(t,e){c(\"Immutable types do not support applying snapshots\")},e.prototype.applyPatchLocally=function(t,e,n){c(\"Immutable types do not support applying patches\")},e.prototype.getChildren=function(t){return u},e.prototype.getChildNode=function(t,e){return c(\"No child '\"+e+\"' available in type: \"+this.name)},e.prototype.getChildType=function(t){return c(\"No child '\"+t+\"' available in type: \"+this.name)},e.prototype.reconcile=function(t,e){if(t.type===this&&t.storedValue===e)return t;var n=this.instantiate(t.parent,t.subpath,t._environment,e);return t.die(),n},e.prototype.removeChild=function(t,e){return c(\"No child '\"+e+\"' available in type: \"+this.name)},e}(Y);function K(){return H(this)+\"(\"+this.size+\" items)\"}function Q(t){var e;if(t||c(\"Map.put cannot be used to set empty values\"),L(t))e=H(t);else{if(!y(t))return c(\"Map.put can only be used to store complex values\");var n=H(this).type.subType;e=H(n.create(t))}return e.identifierAttribute||c(\"Map.put can only be used to store complex values that have an identifier type attribute\"),this.set(e.identifier,e.value),this}var Z=function(t){function e(e,n){var i=t.call(this,e)||this;return i.shouldAttachNode=!0,i.flags=s.Map,i.createNewInstance=function(){var t=r.l.shallowMap();return m(t,\"put\",Q),m(t,\"toString\",K),t},i.finalizeNewInstance=function(t,e){var n=t.storedValue;r.f.interceptReads(n,t.unbox),Object(r.g)(n,function(t){return i.willChange(t)}),t.applySnapshot(e),Object(r.m)(n,i.didChange)},i.subType=n,i}return o(e,t),e.prototype.instantiate=function(t,e,n,r){return J(this,t,e,n,r,this.createNewInstance,this.finalizeNewInstance)},e.prototype.describe=function(){return\"Map<string, \"+this.subType.describe()+\">\"},e.prototype.getChildren=function(t){return t.storedValue.values()},e.prototype.getChildNode=function(t,e){var n=t.storedValue.get(e);return n||c(\"Not a child \"+e),n},e.prototype.willChange=function(t){var e=H(t.object);switch(e.assertWritable(),t.type){case\"update\":var n=t.newValue;if(n===t.object.get(t.name))return null;this.subType,t.newValue=this.subType.reconcile(e.getChildNode(t.name),t.newValue),this.verifyIdentifier(t.name,t.newValue);break;case\"add\":this.subType,t.newValue,t.newValue=this.subType.instantiate(e,t.name,void 0,t.newValue),this.verifyIdentifier(t.name,t.newValue)}return t},e.prototype.verifyIdentifier=function(t,e){var n=e.identifier;null!==n&&\"\"+n!=\"\"+t&&c(\"A map of objects containing an identifier should always store the object under their own identifier. Trying to store key '\"+n+\"', but expected: '\"+t+\"'\")},e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t){var e={};return t.getChildren().forEach(function(t){e[t.subpath]=t.snapshot}),e},e.prototype.didChange=function(t){var e=H(t.object);switch(t.type){case\"update\":return void e.emitPatch({op:\"replace\",path:P(t.name),value:t.newValue.snapshot,oldValue:t.oldValue?t.oldValue.snapshot:void 0},e);case\"add\":return void e.emitPatch({op:\"add\",path:P(t.name),value:t.newValue.snapshot,oldValue:void 0},e);case\"delete\":var n=t.oldValue.snapshot;return t.oldValue.die(),void e.emitPatch({op:\"remove\",path:P(t.name),oldValue:n},e)}},e.prototype.applyPatchLocally=function(t,e,n){var r=t.storedValue;switch(n.op){case\"add\":case\"replace\":r.set(e,n.value);break;case\"remove\":r.delete(e)}},e.prototype.applySnapshot=function(t,e){var n=t.storedValue,r={};n.keys().forEach(function(t){r[t]=!1}),Object.keys(e).forEach(function(t){n.set(t,e[t]),r[t]=!0}),Object.keys(r).forEach(function(t){!1===r[t]&&n.delete(t)})},e.prototype.getChildType=function(t){return this.subType},e.prototype.isValidSnapshot=function(t,e){var n=this;return d(t)?q(Object.keys(t).map(function(r){return n.subType.validate(t[r],W(e,r,n.subType))})):G(e,t,\"Value is not a plain object\")},e.prototype.getDefaultSnapshot=function(){return{}},e.prototype.removeChild=function(t,e){t.storedValue.delete(e)},a([r.c],e.prototype,\"applySnapshot\",null),e}(Y);function tt(){return H(this)+\"(\"+this.length+\" items)\"}var et=function(t){function e(e,n){var i=t.call(this,e)||this;return i.shouldAttachNode=!0,i.flags=s.Array,i.createNewInstance=function(){var t=r.l.shallowArray();return m(t,\"toString\",tt),t},i.finalizeNewInstance=function(t,e){var n=t.storedValue;r.f.getAdministration(n).dehancer=t.unbox,Object(r.g)(n,function(t){return i.willChange(t)}),t.applySnapshot(e),Object(r.m)(n,i.didChange)},i.subType=n,i}return o(e,t),e.prototype.describe=function(){return this.subType.describe()+\"[]\"},e.prototype.instantiate=function(t,e,n,r){return J(this,t,e,n,r,this.createNewInstance,this.finalizeNewInstance)},e.prototype.getChildren=function(t){return t.storedValue.peek()},e.prototype.getChildNode=function(t,e){var n=parseInt(e,10);return n<t.storedValue.length?t.storedValue[n]:c(\"Not a child: \"+e)},e.prototype.willChange=function(t){var e=H(t.object);e.assertWritable();var n=e.getChildren();switch(t.type){case\"update\":if(t.newValue===t.object[t.index])return null;t.newValue=nt(e,this.subType,[n[t.index]],[t.newValue],[t.index])[0];break;case\"splice\":var r=t.index,i=t.removedCount,o=t.added;t.added=nt(e,this.subType,n.slice(r,r+i),o,o.map(function(t,e){return r+e}));for(var a=r+i;a<n.length;a++)n[a].setParent(e,\"\"+(a+o.length-i))}return t},e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t){return t.getChildren().map(function(t){return t.snapshot})},e.prototype.didChange=function(t){var e=H(t.object);switch(t.type){case\"update\":return void e.emitPatch({op:\"replace\",path:\"\"+t.index,value:t.newValue.snapshot,oldValue:t.oldValue?t.oldValue.snapshot:void 0},e);case\"splice\":for(var n=t.removedCount-1;n>=0;n--)e.emitPatch({op:\"remove\",path:\"\"+(t.index+n),oldValue:t.removed[n].snapshot},e);for(n=0;n<t.addedCount;n++)e.emitPatch({op:\"add\",path:\"\"+(t.index+n),value:e.getChildNode(\"\"+(t.index+n)).snapshot,oldValue:void 0},e);return}},e.prototype.applyPatchLocally=function(t,e,n){var r=t.storedValue,i=\"-\"===e?r.length:parseInt(e);switch(n.op){case\"replace\":r[i]=n.value;break;case\"add\":r.splice(i,0,n.value);break;case\"remove\":r.splice(i,1)}},e.prototype.applySnapshot=function(t,e){t.storedValue.replace(e)},e.prototype.getChildType=function(t){return this.subType},e.prototype.isValidSnapshot=function(t,e){var n=this;return h(t)?q(t.map(function(t,r){return n.subType.validate(t,W(e,\"\"+r,n.subType))})):G(e,t,\"Value is not an array\")},e.prototype.getDefaultSnapshot=function(){return[]},e.prototype.removeChild=function(t,e){t.storedValue.splice(parseInt(e,10),1)},a([r.c],e.prototype,\"applySnapshot\",null),e}(Y);function nt(t,e,n,r,i){for(var o,a,s=!1,u=void 0,p=0;o=n[p],(a=r[p])instanceof U&&(a=a.storedValue),s=p<=r.length-1,o||s;p++)if(s)if(o)if(it(o,a))n[p]=rt(e,t,\"\"+i[p],a,o);else{u=void 0;for(var l=p;l<n.length;l++)if(it(n[l],a)){u=n.splice(l,1)[0];break}n.splice(p,0,rt(e,t,\"\"+i[p],a,u))}else L(a)&&H(a).parent===t&&c(\"Cannot add an object to a state tree if it is already part of the same or another state tree. Tried to assign an object to '\"+t.path+\"/\"+i[p]+\"', but it lives already at '\"+H(a).path+\"'\"),n.splice(p,0,rt(e,t,\"\"+i[p],a));else o.die(),n.splice(p,1),p--;return n}function rt(t,e,n,r,i){if(L(r)){var o=H(r);if(o.assertAlive(),null!==o.parent&&o.parent===e)return o.setParent(e,n),i&&i!==o&&i.die(),o}if(i){var a=t.reconcile(i,r);return a.setParent(e,n),a}return t.instantiate(e,n,e._environment,r)}function it(t,e){return L(e)?H(e)===t:!(!y(e)||t.snapshot!==e)||!(null===t.identifier||!t.identifierAttribute||!d(e)||e[t.identifierAttribute]!==t.identifier)}var ot=function(t){function e(e,n,r,i){void 0===i&&(i=l);var o=t.call(this,e)||this;return o.flags=n,o.checker=r,o.initializer=i,o}return o(e,t),e.prototype.describe=function(){return this.name},e.prototype.instantiate=function(t,e,n,r){return J(this,t,e,n,r,this.initializer)},e.prototype.isValidSnapshot=function(t,e){return v(t)&&this.checker(t)?B():G(e,t,\"Value is not a \"+(\"Date\"===this.name?\"Date or a unix milliseconds timestamp\":this.name))},e}(X),at=new ot(\"string\",s.String,function(t){return\"string\"==typeof t}),st=new ot(\"number\",s.Number,function(t){return\"number\"==typeof t}),ut=new ot(\"boolean\",s.Boolean,function(t){return\"boolean\"==typeof t}),pt=new ot(\"null\",s.Null,function(t){return null===t}),ct=new ot(\"undefined\",s.Undefined,function(t){return void 0===t}),lt=new ot(\"Date\",s.Date,function(t){return\"number\"==typeof t||t instanceof Date},function(t){return t instanceof Date?t:new Date(t)});lt.getSnapshot=function(t){return t.storedValue.getTime()};var ft=function(t){function e(e){var n=t.call(this,\"identifier(\"+e.name+\")\")||this;return n.identifierType=e,n.flags=s.Identifier,n}return o(e,t),e.prototype.instantiate=function(t,e,n,r){return t&&L(t.storedValue)?(t.identifierAttribute&&c(\"Cannot define property '\"+e+\"' as object identifier, property '\"+t.identifierAttribute+\"' is already defined as identifier property\"),t.identifierAttribute=e,J(this,t,e,n,r)):c(\"Identifier types can only be instantiated as direct child of a model type\")},e.prototype.reconcile=function(t,e){return t.storedValue!==e?c(\"Tried to change identifier from '\"+t.storedValue+\"' to '\"+e+\"'. Changing identifiers is not allowed.\"):t},e.prototype.describe=function(){return\"identifier(\"+this.identifierType.describe()+\")\"},e.prototype.isValidSnapshot=function(t,e){return null==t||\"string\"==typeof t||\"number\"==typeof t?this.identifierType.validate(t,e):G(e,t,\"Value is not a valid identifier, which is a string or a number\")},e}(X);var ht=function(t){function e(e,n){var r=t.call(this,e.name)||this;return r.type=e,r.defaultValue=n,r}return o(e,t),Object.defineProperty(e.prototype,\"flags\",{get:function(){return this.type.flags|s.Optional},enumerable:!0,configurable:!0}),e.prototype.describe=function(){return this.type.describe()+\"?\"},e.prototype.instantiate=function(t,e,n,r){if(void 0===r){var i=this.getDefaultValue(),o=L(i)?H(i).snapshot:i;return this.type.instantiate(t,e,n,o)}return this.type.instantiate(t,e,n,r)},e.prototype.reconcile=function(t,e){return this.type.reconcile(t,this.type.is(e)?e:this.getDefaultValue())},e.prototype.getDefaultValue=function(){var t=\"function\"==typeof this.defaultValue?this.defaultValue():this.defaultValue;return this.defaultValue,t},e.prototype.isValidSnapshot=function(t,e){return void 0===t?B():this.type.validate(t,e)},e.prototype.isAssignableFrom=function(t){return this.type.isAssignableFrom(t)},e}(X);function dt(t,e){return new ht(t,e)}var yt={afterCreate:\"afterCreate\",afterAttach:\"afterAttach\",postProcessSnapshot:\"postProcessSnapshot\",beforeDetach:\"beforeDetach\",beforeDestroy:\"beforeDestroy\"};function vt(){return H(this).toString()}var bt={name:\"AnonymousModel\",properties:{},initializers:u};function mt(t){return Object.keys(t).reduce(function(t,e){if(e in yt)return c(\"Hook '\"+e+\"' was defined as property. Hooks should be defined as part of the actions\");var n=Object.getOwnPropertyDescriptor(t,e);\"get\"in n&&c(\"Getters are not supported as properties. Please use views instead\");var r,i=n.value;if(null===i)c(\"The default value of an attribute cannot be null or undefined as the type cannot be inferred. Did you mean `types.maybe(someType)`?\");else{if(v(i))return Object.assign({},t,((r={})[e]=dt(function(t){switch(typeof t){case\"string\":return at;case\"number\":return st;case\"boolean\":return ut;case\"object\":if(t instanceof Date)return lt}return c(\"Cannot determine primtive type from value \"+t)}(i),i),r));if(S(i))return t;c(\"function\"==typeof i?\"Functions are not supported as properties, use views instead\":\"object\"==typeof i?\"In property '\"+e+\"': base model's should not contain complex values: '\"+i+\"'\":\"Unexpected value for property '\"+e+\"'\")}},t)}var gt=function(t){function e(e){var n=t.call(this,e.name||bt.name)||this;n.flags=s.Object,n.createNewInstance=function(){var t=r.l.shallowObject(p);return m(t,\"toString\",vt),t},n.finalizeNewInstance=function(t,e){var i=t.storedValue;n.forAllProps(function(n,o){var a;Object(r.e)(i,((a={})[n]=r.l.ref(o.instantiate(t,n,t._environment,e[n])),a)),r.f.interceptReads(t.storedValue,n,t.unbox)}),n.initializers.reduce(function(t,e){return e(t)},i),Object(r.g)(i,function(t){return n.willChange(t)}),Object(r.m)(i,n.didChange)},n.didChange=function(t){var e=H(t.object);e.emitPatch({op:\"replace\",path:P(t.name),value:t.newValue.snapshot,oldValue:t.oldValue?t.oldValue.snapshot:void 0},e)};var i=e.name||bt.name;return/^\\w[\\w\\d_]*$/.test(i)||c(\"Typename should be a valid identifier: \"+i),Object.assign(n,bt,e),n.properties=mt(n.properties),n.propertiesNames=Object.keys(n.properties),Object.freeze(n.properties),n}return o(e,t),e.prototype.extend=function(t){return new e({name:t.name||this.name,properties:Object.assign({},this.properties,t.properties),initializers:this.initializers.concat(t.initializers||[]),preProcessor:t.preProcessor||this.preProcessor})},e.prototype.actions=function(t){return this.extend({initializers:[function(e){var n=t(e);return d(n)||c(\"actions initializer should return a plain object containing actions\"),Object.keys(n).forEach(function(t){if(\"preProcessSnapshot\"===t)return c(\"Cannot define action 'preProcessSnapshot', it should be defined using 'type.preProcessSnapshot(fn)' instead\");var r=n[t],i=e[t];if(t in yt&&i){var o=r;r=t===yt.postProcessSnapshot?function(t){return o(i(t))}:function(){i.apply(null,arguments),o.apply(null,arguments)}}m(e,t,R(e,t,r))}),e}]})},e.prototype.named=function(t){return this.extend({name:t})},e.prototype.props=function(t){return this.extend({properties:t})},e.prototype.views=function(t){return this.extend({initializers:[function(e){var n=t(e);return d(n)||c(\"views initializer should return a plain object containing views\"),Object.keys(n).forEach(function(t){var i=Object.getOwnPropertyDescriptor(n,t),o=i.value;if(\"get\"in i)if(Object(r.h)(e.$mobx.values[t]))e.$mobx.values[t]=Object(r.d)(i.get,{name:t,setter:i.set,context:e});else{var a={};Object.defineProperty(a,t,{get:i.get,set:i.set,enumerable:!0}),Object(r.e)(e,a)}else\"function\"==typeof o?m(e,t,o):c(\"A view member should either be a function or getter based property\")}),e}]})},e.prototype.preProcessSnapshot=function(t){var e=this.preProcessor;return e?this.extend({preProcessor:function(n){return e(t(n))}}):this.extend({preProcessor:t})},e.prototype.instantiate=function(t,e,n,r){return J(this,t,e,n,this.applySnapshotPreProcessor(r),this.createNewInstance,this.finalizeNewInstance)},e.prototype.willChange=function(t){var e=H(t.object),n=this.properties[t.name];return e.assertWritable(),t.newValue,t.newValue=n.reconcile(e.getChildNode(t.name),t.newValue),t},e.prototype.getChildren=function(t){var e=this,n=[];return this.forAllProps(function(r,i){n.push(e.getChildNode(t,r))}),n},e.prototype.getChildNode=function(t,e){if(!(e in this.properties))return c(\"Not a value property: \"+e);var n=t.storedValue.$mobx.values[e].value;return n||c(\"Node not available for property \"+e)},e.prototype.getValue=function(t){return t.storedValue},e.prototype.getSnapshot=function(t){var e=this,n={};return this.forAllProps(function(i,o){r.f.getAtom(t.storedValue,i).reportObserved(),n[i]=e.getChildNode(t,i).snapshot}),\"function\"==typeof t.storedValue.postProcessSnapshot?t.storedValue.postProcessSnapshot.call(null,n):n},e.prototype.applyPatchLocally=function(t,e,n){\"replace\"!==n.op&&\"add\"!==n.op&&c(\"object does not support operation \"+n.op),t.storedValue[e]=n.value},e.prototype.applySnapshot=function(t,e){var n=this.applySnapshotPreProcessor(e);this.forAllProps(function(e,r){t.storedValue[e]=n[e]})},e.prototype.applySnapshotPreProcessor=function(t){return this.preProcessor?this.preProcessor.call(null,t):t},e.prototype.getChildType=function(t){return this.properties[t]},e.prototype.isValidSnapshot=function(t,e){var n=this,r=this.applySnapshotPreProcessor(t);return d(r)?q(this.propertiesNames.map(function(t){return n.properties[t].validate(r[t],W(e,t,n.properties[t]))})):G(e,r,\"Value is not a plain object\")},e.prototype.forAllProps=function(t){var e=this;this.propertiesNames.forEach(function(n){return t(n,e.properties[n])})},e.prototype.describe=function(){var t=this;return\"{ \"+this.propertiesNames.map(function(e){return e+\": \"+t.properties[e].describe()}).join(\"; \")+\" }\"},e.prototype.getDefaultSnapshot=function(){return{}},e.prototype.removeChild=function(t,e){t.storedValue[e]=null},a([r.c],e.prototype,\"applySnapshot\",null),e}(Y);var wt=function(){return function(t,e){if(this.mode=t,this.value=e,\"object\"===t){if(!L(e))return c(\"Can only store references to tree nodes, got: '\"+e+\"'\");if(!H(e).identifierAttribute)return c(\"Can only store references with a defined identifier attribute.\")}}}(),Vt=function(t){function e(e){var n=t.call(this,\"reference(\"+e.name+\")\")||this;return n.targetType=e,n.flags=s.Reference,n}return o(e,t),e.prototype.describe=function(){return this.name},e.prototype.getValue=function(t){var e=t.storedValue;if(\"object\"===e.mode)return e.value;if(t.isAlive){var n=t.root.identifierCache.resolve(this.targetType,e.value);return n?n.value:c(\"Failed to resolve reference of type \"+this.targetType.name+\": '\"+e.value+\"' (in: \"+t.path+\")\")}},e.prototype.getSnapshot=function(t){var e=t.storedValue;switch(e.mode){case\"identifier\":return e.value;case\"object\":return H(e.value).identifier}},e.prototype.instantiate=function(t,e,n,r){var i=L(r);return J(this,t,e,n,new wt(i?\"object\":\"identifier\",r))},e.prototype.reconcile=function(t,e){var n=L(e)?\"object\":\"identifier\";if((t.type.flags&s.Reference)>0){var r=t.storedValue;if(n===r.mode&&r.value===e)return t}var i=this.instantiate(t.parent,t.subpath,t._environment,e);return t.die(),i},e.prototype.isAssignableFrom=function(t){return this.targetType.isAssignableFrom(t)},e.prototype.isValidSnapshot=function(t,e){return\"string\"==typeof t||\"number\"==typeof t?B():G(e,t,\"Value is not a valid identifier, which is a string or a number\")},e}(X);var jt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.dispatcher=null,i.dispatcher=r,i.types=n,i}return o(e,t),Object.defineProperty(e.prototype,\"flags\",{get:function(){var t=s.Union;return this.types.forEach(function(e){t|=e.flags}),t},enumerable:!0,configurable:!0}),e.prototype.isAssignableFrom=function(t){return this.types.some(function(e){return e.isAssignableFrom(t)})},e.prototype.describe=function(){return\"(\"+this.types.map(function(t){return t.describe()}).join(\" | \")+\")\"},e.prototype.instantiate=function(t,e,n,r){return this.determineType(r).instantiate(t,e,n,r)},e.prototype.reconcile=function(t,e){return this.determineType(e).reconcile(t,e)},e.prototype.determineType=function(t){if(null!==this.dispatcher)return this.dispatcher(t);var e=this.types.filter(function(e){return e.is(t)});return e.length>1?c(\"Ambiguos snapshot \"+JSON.stringify(t)+\" for union \"+this.name+\". Please provide a dispatch in the union declaration.\"):e[0]},e.prototype.isValidSnapshot=function(t,e){if(null!==this.dispatcher)return this.dispatcher(t).validate(t,e);var n=this.types.map(function(n){return n.validate(t,e)}),r=n.filter(function(t){return 0===t.length});return r.length>1?G(e,t,\"Multiple types are applicable for the union (hint: provide a dispatch function)\"):0===r.length?G(e,t,\"No type is applicable for the union\").concat(q(n)):B()},e}(X);function Pt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=S(t)?null:t,i=S(t)?e.concat(t):e,o=\"(\"+i.map(function(t){return t.name}).join(\" | \")+\")\";return new jt(o,i,r)}var Tt=function(t){function e(e){var n=t.call(this,JSON.stringify(e))||this;return n.flags=s.Literal,n.value=e,n}return o(e,t),e.prototype.instantiate=function(t,e,n,r){return J(this,t,e,n,r)},e.prototype.describe=function(){return JSON.stringify(this.value)},e.prototype.isValidSnapshot=function(t,e){return v(t)&&t===this.value?B():G(e,t,\"Value is not a literal \"+JSON.stringify(this.value))},e}(X);function Ct(t){return new Tt(t)}var Ot=new(function(t){function e(){var e=t.call(this,\"frozen\")||this;return e.flags=s.Frozen,e}return o(e,t),e.prototype.describe=function(){return\"<any immutable value>\"},e.prototype.instantiate=function(t,e,n,r){return J(this,t,e,n,function t(e){return b(e),d(e)&&Object.keys(e).forEach(function(n){v(e[n])||Object.isFrozen(e[n])||t(e[n])}),e}(r))},e.prototype.isValidSnapshot=function(t,e){return function(t){return\"function\"!=typeof t}(t)?B():G(e,t,\"Value is not serializable and cannot be frozen\")},e}(X)),St=dt(pt,null);var _t=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.type=n,o.predicate=r,o.message=i,o}return o(e,t),Object.defineProperty(e.prototype,\"flags\",{get:function(){return this.type.flags|s.Refinement},enumerable:!0,configurable:!0}),e.prototype.describe=function(){return this.name},e.prototype.instantiate=function(t,e,n,r){return this.type.instantiate(t,e,n,r)},e.prototype.isAssignableFrom=function(t){return this.type.isAssignableFrom(t)},e.prototype.isValidSnapshot=function(t,e){var n=this.type.validate(t,e);if(n.length>0)return n;var r=L(t)?H(t).snapshot:t;return this.predicate(r)?B():G(e,t,this.message(t))},e}(X);var At=function(t){function e(e,n){var r=t.call(this,e)||this;return r._subType=null,r.definition=n,r}return o(e,t),Object.defineProperty(e.prototype,\"flags\",{get:function(){return this.subType.flags|s.Late},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"subType\",{get:function(){return null===this._subType&&(this._subType=this.definition()),this._subType},enumerable:!0,configurable:!0}),e.prototype.instantiate=function(t,e,n,r){return this.subType.instantiate(t,e,n,r)},e.prototype.reconcile=function(t,e){return this.subType.reconcile(t,e)},e.prototype.describe=function(){return this.subType.name},e.prototype.isValidSnapshot=function(t,e){return this.subType.validate(t,e)},e.prototype.isAssignableFrom=function(t){return this.subType.isAssignableFrom(t)},e}(X);var xt={enumeration:function(t,e){var n=\"string\"==typeof t?e:t,r=Pt.apply(void 0,n.map(function(t){return Ct(\"\"+t)}));return\"string\"==typeof t&&(r.name=t),r},model:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=\"string\"==typeof t[0]?t.shift():\"AnonymousModel\",r=t.shift()||{};return new gt({name:n,properties:r})},compose:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=\"string\"==typeof t[0]?t.shift():\"AnonymousModel\";return t.reduce(function(t,e){return t.extend({name:t.name+\"_\"+e.name,properties:e.properties,initializers:e.initializers})}).named(n)},reference:function(t){return new Vt(t)},union:Pt,optional:dt,literal:Ct,maybe:function(t){return Pt(St,t)},refinement:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=\"string\"==typeof t[0]?t.shift():S(t[0])?t[0].name:null,r=t[0],i=t[1],o=t[2]?t[2]:function(t){return\"Value does not respect the refinement predicate\"};return new _t(n,r,i,o)},string:at,boolean:ut,number:st,Date:lt,map:function(t){return new Z(\"map<string, \"+t.name+\">\",t)},array:function(t){return new et(t.name+\"[]\",t)},frozen:Ot,identifier:function(t){return void 0===t&&(t=at),new ft(t)},late:function(t,e){var n=\"string\"==typeof t?t:\"late(\"+t.toString()+\")\";return new At(n,\"string\"==typeof t?e:t)},undefined:ct,null:pt}}).call(this,n(212).setImmediate)},81:function(t,e,n){t.exports=n(91)},82:function(t,e,n){t.exports=n(214)}},[[211,1,0]]]);","extractedComments":[]}